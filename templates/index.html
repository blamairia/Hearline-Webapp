<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Clinic Dashboard</title>  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body class="p-3">
  <div class="container">
    <h1>Clinic Dashboard</h1>

    <p class="mb-4">
      <a href="{{ url_for('create_patient') }}" class="btn btn-primary">New Patient</a>
      <a href="{{ url_for('create_visit') }}" class="btn btn-success">New Visit</a>
    </p>

    <h2>Recent Patients</h2>
    <ul class="list-group mb-4">
      {% for p in patients %}
        <li class="list-group-item">
          {{ p.first_name }} {{ p.last_name }} &mdash;
          DOB: {{ p.date_of_birth.strftime('%Y-%m-%d') }}
        </li>
      {% else %}
        <li class="list-group-item">No patients yet.</li>
      {% endfor %}
    </ul>    <h2>Recent Visits</h2>
    <div class="list-group">
      {% for v in visits %}
        <a href="{{ url_for('visit_details', visit_id=v.id) }}" class="list-group-item list-group-item-action">
          <div class="d-flex w-100 justify-content-between">
            <h6 class="mb-1">Visit #{{ v.id }} - {{ v.patient.first_name }} {{ v.patient.last_name }}</h6>
            <small class="text-muted">{{ v.visit_date.strftime('%Y-%m-%d %H:%M') }}</small>
          </div>
          <p class="mb-1">
            {% if v.diagnosis %}
              <strong>Diagnosis:</strong> {{ v.diagnosis[:100] }}{% if v.diagnosis|length > 100 %}...{% endif %}
            {% else %}
              <em>No diagnosis recorded</em>
            {% endif %}
          </p>
          <small class="text-muted">
            Payment: 
            <span class="badge {% if v.payment_status == 'paid' %}badge-success{% elif v.payment_status == 'partial' %}badge-warning{% else %}badge-danger{% endif %}">
              {{ v.payment_status | capitalize }}
            </span>
            {% if v.ecg_mat and v.ecg_hea %}
              <span class="badge badge-info ml-2"><i class="fas fa-heartbeat"></i> ECG Available</span>
            {% endif %}
          </small>
        </a>
      {% else %}
        <div class="list-group-item">No visits yet.</div>
      {% endfor %}
    </div>
  </div>
</body>
</html>
